<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ —É—Å–ª—É–≥–∏ - MineCraft Hosting</title>
    <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ —Ñ–æ–Ω–µ -->
    <div class="floating-objects">
        <div class="floating-cube"></div>
        <div class="floating-cube"></div>
        <div class="floating-cube"></div>
        <div class="floating-cube"></div>
        <div class="floating-cube"></div>
        <div class="floating-diamond"></div>
        <div class="floating-diamond"></div>
        <div class="floating-diamond"></div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –∫–æ—Ä–∑–∏–Ω—ã -->
    <div class="cart-panel" id="cart-panel">
        <div class="cart-header">
            <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
            <button class="cart-close" onclick="toggleCart()">&times;</button>
        </div>
        <div class="cart-items" id="cart-items">
            <div class="cart-empty">
                <div class="cart-empty-icon">üõí</div>
                <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                <p style="font-size: 0.9rem; margin-top: 0.5rem;">–î–æ–±–∞–≤—å—Ç–µ —Ç–∞—Ä–∏—Ñ—ã –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞</p>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span class="cart-total-label">–ò—Ç–æ–≥–æ:</span>
                <span class="cart-total-amount" id="cart-total">0 ‚ÇΩ</span>
            </div>
            <button class="cart-checkout-btn" onclick="checkoutFromCart()" disabled id="cart-checkout-btn">
                –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
            </button>
        </div>
    </div>

    <nav>
        <div class="nav-container">
            <a href="/" class="logo">MINECRAFT HOSTING</a>
            <ul class="nav-links">
                <li><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="/shop">–¢–∞—Ä–∏—Ñ—ã</a></li>
                <li><a href="/constructor">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</a></li>
                <li><a href="/services" class="active">–ú–æ–∏ —É—Å–ª—É–≥–∏</a></li>
            </ul>
            <div class="nav-actions">
                <div class="balance-display" style="display: none;">
                    <span class="balance-label">–ë–∞–ª–∞–Ω—Å:</span>
                    <span class="balance-amount">0 ‚ÇΩ</span>
                </div>
                <button class="cart-button" onclick="toggleCart()">
                    üõí
                    <span class="cart-badge" id="cart-badge" style="display: none;">0</span>
                </button>
                <button class="nav-btn login-btn">–í–æ–π—Ç–∏</button>
                <button class="nav-btn register-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <div class="user-profile" id="user-profile" style="display: none;">
                    <button class="profile-button" onclick="toggleProfileMenu()">
                        <span class="profile-avatar" id="profile-avatar">üë§</span>
                    </button>
                    <div class="profile-menu" id="profile-menu">
                        <div class="profile-header">
                            <div class="profile-name" id="profile-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                            <div class="profile-email" id="profile-email">user@email.com</div>
                        </div>
                        <div class="profile-balance">
                            <span class="balance-label">–ë–∞–ª–∞–Ω—Å:</span>
                            <span class="balance-amount" id="user-balance">0 ‚ÇΩ</span>
                        </div>
                        <div class="profile-menu-items">
                            <a href="/services" class="profile-menu-item">üìä –ú–æ–∏ —É—Å–ª—É–≥–∏</a>
                            <a href="#" class="profile-menu-item">üí≥ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</a>
                            <a href="#" class="profile-menu-item" onclick="openChangePasswordModal()">üîë –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>
                            <a href="#" class="profile-menu-item logout-item" onclick="logout()">üö™ –í—ã—Ö–æ–¥</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="container">
        <section class="services-section">
            <div class="services-header">
                <h1>–ú–æ–∏ –£—Å–ª—É–≥–∏</h1>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Minecraft</p>
            </div>

            <div class="services-container" id="services-container">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä—ã -->
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 MineCraft Hosting. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('loginModal')">&times;</button>
            <h2>–í—Ö–æ–¥</h2>
            <form class="modal-form" id="loginForm">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="login-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="login-password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="modal-submit">–í–æ–π—Ç–∏</button>
            </form>
            <div class="modal-switch">
                <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="switchModal('loginModal', 'registerModal')">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
            </div>
        </div>
    </div>

    <div class="modal" id="registerModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('registerModal')">&times;</button>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form class="modal-form" id="registerForm">
                <div class="form-group">
                    <label for="register-name">–ò–º—è</label>
                    <input type="text" id="register-name" name="name" required placeholder="–í–∞—à–µ –∏–º—è">
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" name="email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="register-password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="register-password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="modal-submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
            <div class="modal-switch">
                <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="switchModal('registerModal', 'loginModal')">–í–æ–π—Ç–∏</a></p>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('changePasswordModal')">&times;</button>
            <h2>–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h2>
            <form class="modal-form" id="changePasswordForm">
                <div class="form-group">
                    <label for="current-password">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="current-password" name="current-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-group">
                    <label for="new-password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="new-password" name="new-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-group">
                    <label for="confirm-new-password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="confirm-new-password" name="confirm-new-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="modal-submit">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </form>
        </div>
    </div>

    <script src="/scripts/app.js"></script>
    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ª—É–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.addEventListener('DOMContentLoaded', () => {
            loadUserServices();
        });

        function loadUserServices() {
            const user = JSON.parse(localStorage.getItem('user') || 'null');
            const servicesContainer = document.getElementById('services-container');
            
            if (!user || !user.loggedIn) {
                servicesContainer.innerHTML = `
                    <div class="no-services">
                        <div class="no-services-icon">üîí</div>
                        <h2>–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                        <p>–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ —É—Å–ª—É–≥–∏</p>
                        <button class="nav-btn" onclick="openModal('loginModal')">–í–æ–π—Ç–∏</button>
                    </div>
                `;
                return;
            }

            const allOrders = JSON.parse(localStorage.getItem('userOrders') || '[]');
            const userOrders = allOrders.filter(order => order.userId === user.email);

            if (userOrders.length === 0) {
                servicesContainer.innerHTML = `
                    <div class="no-services">
                        <div class="no-services-icon">üì¶</div>
                        <h2>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥</h2>
                        <p>–ó–∞–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä Minecraft</p>
                        <a href="/shop" class="nav-btn">–í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ</a>
                    </div>
                `;
                return;
            }

            servicesContainer.innerHTML = userOrders.map((order, index) => {
                const cartData = order.cart || [];
                
                return `
                    <div class="service-card" style="animation-delay: ${index * 0.1}s">
                        <div class="service-header">
                            <div class="service-title">
                                <h2>üñ•Ô∏è ${order.serverName || '–ú–æ–π —Å–µ—Ä–≤–µ—Ä'}</h2>
                                <span class="service-status service-status-${order.status}">${order.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</span>
                            </div>
                            <div class="service-date">–°–æ–∑–¥–∞–Ω: ${new Date(order.orderDate).toLocaleDateString('ru-RU')}</div>
                        </div>

                        <div class="service-specs">
                            ${cartData.map(item => `
                                <div class="service-plan">
                                    <div class="plan-badge">${item.name}</div>
                                    <div class="spec-grid">
                                        <div class="spec-item">
                                            <span class="spec-icon">üíæ</span>
                                            <span class="spec-label">RAM:</span>
                                            <span class="spec-value">${item.ram}</span>
                                        </div>
                                        <div class="spec-item">
                                            <span class="spec-icon">üîß</span>
                                            <span class="spec-label">vCPU:</span>
                                            <span class="spec-value">${item.cpu}</span>
                                        </div>
                                        <div class="spec-item">
                                            <span class="spec-icon">üíø</span>
                                            <span class="spec-label">–î–∏—Å–∫:</span>
                                            <span class="spec-value">${item.storage}</span>
                                        </div>
                                        ${item.ports ? `
                                        <div class="spec-item">
                                            <span class="spec-icon">üîå</span>
                                            <span class="spec-label">–ü–æ—Ä—Ç—ã:</span>
                                            <span class="spec-value">${item.ports}</span>
                                        </div>
                                        ` : ''}
                                        ${item.databases ? `
                                        <div class="spec-item">
                                            <span class="spec-icon">üóÑÔ∏è</span>
                                            <span class="spec-label">–ë–î:</span>
                                            <span class="spec-value">${item.databases}</span>
                                        </div>
                                        ` : ''}
                                        ${item.backups ? `
                                        <div class="spec-item">
                                            <span class="spec-icon">üíæ</span>
                                            <span class="spec-label">–ë—ç–∫–∞–ø—ã:</span>
                                            <span class="spec-value">${item.backups}</span>
                                        </div>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–π –±–ª–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–∞–Ω–µ–ª–∏ –≤–Ω–∏–∑—É
            if (userOrders.length > 0) {
                const user = JSON.parse(localStorage.getItem('user'));
                // –ë–µ—Ä–µ–º –ø–∞—Ä–æ–ª—å –ø–∞–Ω–µ–ª–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ (–æ–Ω –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
                const panelPassword = userOrders[0].panelPassword;
                
                servicesContainer.innerHTML += `
                    <div class="panel-info-section">
                        <h2>–î–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
                        <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 2rem;">–î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º –≤–∞—à–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º</p>
                        
                        <div class="panel-credentials">
                            <div class="panel-item">
                                <span class="panel-label">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</span>
                                <a href="http://108.165.164.141/" target="_blank" class="panel-link">http://108.165.164.141/</a>
                            </div>
                            <div class="panel-item">
                                <span class="panel-label">–õ–æ–≥–∏–Ω:</span>
                                <span class="panel-value">${user.email}</span>
                            </div>
                            <div class="panel-item">
                                <span class="panel-label">–ü–∞—Ä–æ–ª—å:</span>
                                <div class="password-container">
                                    <span class="panel-password" id="main-password">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
                                    <button class="password-toggle" onclick="toggleMainPassword('${panelPassword}')">üëÅÔ∏è</button>
                                </div>
                            </div>
                        </div>

                        <div class="panel-actions">
                            <a href="http://108.165.164.141/" target="_blank" class="service-btn service-btn-primary">
                                üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                            </a>
                            <button class="service-btn service-btn-secondary" onclick="openChangePasswordModal()">
                                üîë –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        function toggleMainPassword(password) {
            const passwordElement = document.getElementById('main-password');
            const button = event.target;
            
            if (passwordElement.textContent === '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢') {
                passwordElement.textContent = password;
                button.textContent = 'üôà';
            } else {
                passwordElement.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                button.textContent = 'üëÅÔ∏è';
            }
        }
    </script>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('changePasswordModal')">&times;</button>
            <h2>–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h2>
            <form class="modal-form" id="changePasswordForm">
                <div class="form-group">
                    <label for="current-password">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="current-password" name="current-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-group">
                    <label for="new-password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="new-password" name="new-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-group">
                    <label for="confirm-new-password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="confirm-new-password" name="confirm-new-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="modal-submit">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </form>
        </div>
    </div>
</body>
</html>
